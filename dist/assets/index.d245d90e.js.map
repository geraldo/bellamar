{"version":3,"file":"index.d245d90e.js","sources":["../../vite/modulepreload-polyfill","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import './style.css';\n\nimport {Map, View} from 'ol';\nimport {Tile as TileLayer, Vector as VectorLayer, Group as GroupLayer} from 'ol/layer';\nimport {OSM, TileWMS, TileArcGISRest, Vector as VectorSource, XYZ} from 'ol/source';\nimport {transform,fromLonLat,toLonLat} from 'ol/proj';\nimport {ScaleLine, defaults as defaultControls, Attribution} from 'ol/control';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {Select, Draw} from 'ol/interaction';\nimport {Overlay as OverlayOL} from 'ol';\nimport {Style, Stroke, Fill, Circle} from 'ol/style';\nimport {LineString, Polygon} from 'ol/geom';\nimport {getArea, getLength} from 'ol/sphere';\nimport {unByKey} from 'ol/Observable';\n\nimport $ from 'jquery';\nimport LayerSwitcher from 'ol-layerswitcher';\nimport Permalink from 'ol-ext/control/Permalink';\nimport Bar from 'ol-ext/control/Bar';\nimport Button from 'ol-ext/control/Button';\nimport Toggle from 'ol-ext/control/Toggle';\nimport Overlay from 'ol-ext/control/Overlay';\nimport GeolocationButton from 'ol-ext/control/GeolocationButton';\nimport Popup from 'ol-ext/overlay/Popup';\n\nconst zoomInit = 16,\n      coordsInit = fromLonLat([ 1.957, 41.271 ]),\n      qgisserverUrl = 'https://mapa.psig.es/qgisserver/cgi-bin/qgis_mapserv.fcgi',\n      mapproxyUrl = 'https://mapa.psig.es/mapproxy/service',\n      wfsUrl = 'https://mapa.psig.es/qgisserver/wfs3/collections/',\n      wfsItems = '/items.geojson',\n      wfsMapPath = '?MAP=/home/ubuntu/bellamar/Obra_Bellamar_web.qgs',\n      wfsLimit = '&limit=10000';\n\n/*\n * Base Layers\n *****************************************/\nlet baseLayers = new GroupLayer({\n  title: 'Mapes base',\n  //fold: 'close',\n  layers: [\n\n    new TileLayer({\n      title: 'Ningú',\n      type: 'base',\n      source: null,\n      visible: false,\n    }),\n\n    new TileLayer({\n      title: 'OpenStreetMap',\n      type: 'base',\n      visible: false,\n      source: new OSM()\n    }),\n\n    new TileLayer({\n      title: 'Ortofoto històrica de 2020 (AMB)',\n      type: 'base',\n      visible: false,\n      source: new TileArcGISRest({\n        url: 'https://geoportal.amb.cat/geoserveis/rest/services/ortofoto_territorial_10cm_2020_25831/MapServer',\n        projection: 'EPSG:25831',\n        params: {\n          'LAYERS': 'Orto2020_10cm'\n        },\n        attributions: ['© <a target=\"_blank\" href=\"https://www.amb.cat/\">AMB</a>'],\n      })\n    }),\n\n    // new TileLayer({\n    //   title: 'Topográfic (AMB)',\n    //   type: 'base',\n    //   visible: true,\n    //   maxZoom: 18,\n    //   source: new TileWMS({\n    //     url: 'https://geoserveis.icgc.cat/icc_ct1m/wms/service?',\n    //     projection: 'EPSG:25831',\n    //     params: {\n    //       'LAYERS': 'V21_PL,V22_PL,V21_LN,V22_LN,V21_PN,V22_PN,V21_TX_ANNO,V22_TX_ANNO', \n    //       'VERSION': '1.1.1'\n    //     },\n    //     attributions: ['Cartografia topogràfica 1:1.000 de l’<a target=\"_blank\" href=\"http://www.icgc.cat/\">Institut Cartogràfic i Geològic de Catalunya (ICGC)</a>, sota una llicència <a target=\"_blank\" href=\"https://creativecommons.org/licenses/by/4.0/deed.ca\">CC BY 4.0</a>'],\n    //   })\n    // }),\n\n    new TileLayer({\n      title: 'Topográfic (AMB)',\n      type: 'base',\n      visible: true,\n      maxZoom: 18,\n      source: new TileWMS({\n        url: 'http://geoserveis.icc.cat/icc_mapesmultibase/utm/wms/service?',\n        params: {\n          'LAYERS': 'topogris', \n          'VERSION': '1.1.1'\n        },\n        attributions: ['Cartografia topogràfica 1:1.000 de l’<a target=\"_blank\" href=\"http://www.icgc.cat/\">Institut Cartogràfic i Geològic de Catalunya (ICGC)</a>, sota una llicència <a target=\"_blank\" href=\"https://creativecommons.org/licenses/by/4.0/deed.ca\">CC BY 4.0</a>'],\n       })\n    }),\n  ]\n});\n\n/*\n * Overlay Layers\n *****************************************/\nlet topoLayer = new TileLayer({\n  title: 'Topografia completa',\n  visible: true,\n  minZoom: 18,\n  source: new TileWMS({\n    //url: qgisserverUrl + wfsMapPath,\n    url: mapproxyUrl + wfsMapPath,\n    params: {\n      'LAYERS': 'bellamar_topografia',\n      //'LAYERS': 'Anotacions,Vegetació (punts),Comunicacions (lineas),Vegetació (líneas),Construccions (líneas),Hidrografia (líneas)',\n      'TRANSPARENT': true,\n      'VERSION': '1.3.0',\n    },\n    serverType: 'qgis'\n  })\n});\n\nlet catastroLayer = new TileLayer({\n  title: 'Catastro',\n  visible: false,\n  source: new TileWMS({\n    url: 'http://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx',\n    params: {\n      'LAYERS': 'catastro', \n      'TILED': true,\n      'SRS': 'EPSG:3857'\n    }\n  })\n});\n\nlet pluvialLayer = new VectorLayer({\n  title: 'Pluvial',\n  visible: true,\n  source: new VectorSource({\n    format: new GeoJSON(),\n    url: wfsUrl + 'bellamar_pluvial' + wfsItems + wfsMapPath + wfsLimit\n    //url: 'bellamar_pluvial.geojson'\n  }),\n  style: new Style({\n    stroke: new Stroke({\n      lineDash: [10, 5],\n      color: '#1f78b4',\n      width: 3\n    })\n  })\n});\n\nlet tramsLayer = new VectorLayer({\n  title: 'Trams de les obres',\n  name: 'trams',\n  visible: true,\n  source: new VectorSource({\n    format: new GeoJSON(),\n    url: wfsUrl + 'Trams de les obres' + wfsItems + wfsMapPath + wfsLimit\n    //url: 'Trams de les obres.geojson'\n  }),\n  style: function(feature, resolution) {\n    let estat = feature.get('estat');\n    if (estat === 'finalitzat') {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#09de00\",\n          width: 2\n        })\n      })\n    }\n    else if (estat === 'en obra') {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#db1e2a\",\n          width: 2\n        })\n      })\n    }\n    else if (estat === 'inici en breu') {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#ff8c00\",\n          width: 2\n        })\n      })\n    }\n    else if (estat === 'pendent') {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#0076b6\",\n          width: 2\n        })\n      })\n    }\n    else if (estat === 'exclòs') {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#929397\",\n          width: 1\n        })\n      })\n    }\n    else {\n      return new Style({\n        stroke: new Stroke({\n          color: \"#ffff00\",\n          width: 1\n        })\n      })\n    }\n  }\n});\n\nlet parcellesLayer = new VectorLayer({\n  title: 'Parcel·les projecte Bellamar',\n  name: 'parcelles',\n  visible: true,\n  source: new VectorSource({\n    format: new GeoJSON(),\n    url: wfsUrl + 'Parcel·les projecte Bellamar' + wfsItems + wfsMapPath + wfsLimit\n    //url: 'Parcel·les projecte Bellamar.geojson'\n  }),\n  style: function(feature, resolution) {\n    if (feature.get('residual') === 'No') {\n      return new Style({\n        fill: new Fill({\n          //color: \"#c49a97\"\n          color: \"rgba(196,154,151,0.4)\"\n        })\n      })\n    }\n    else if (feature.get('residual') === 'Sí') {\n      return new Style({\n        fill: new Fill({\n          //color: \"#876964\"\n          color: \"rgba(135,105,100,0.4)\"\n        })\n      })\n    }\n    else {\n      return null;\n    }\n  }\n});\n\nlet barrisLayer = new VectorLayer({\n  title: 'Barris',\n  visible: true,\n  source: new VectorSource({\n    format: new GeoJSON(),\n    url: 'barris.geojson',\n  }),\n  style: new Style({\n    stroke: new Stroke({\n      color: \"#000\",\n      width: 2\n    })\n  })\n});\n\n/*\n * Map\n *****************************************/\nconst map = new Map({\n  target: 'map',\n  controls: defaultControls().extend([new ScaleLine()]),\n  layers: new GroupLayer({\n    title: 'Mapes base',\n    fold: 'close',\n    layers: [\n      baseLayers,\n      catastroLayer,\n      topoLayer,\n      barrisLayer,\n      pluvialLayer,\n      tramsLayer,\n      parcellesLayer,\n    ]\n  }),\n  view: new View({\n    //center: fromLonLat([1.982, 41.286]),\n    center: coordsInit,\n    zoom: zoomInit,\n    minZoom: 14,\n    maxZoom: 20\n  })\n});\n\n/*\n * Menu\n *****************************************/\nlet infoWindowDocs = new Overlay({ \n  closeBox : true, \n  className: \"slide-left menu\", \n  content: $(\"#infoWindowDocs\").get(0)\n});\nmap.addControl(infoWindowDocs);\n\nlet infoWindowLayers = new Overlay({ \n  closeBox : true, \n  className: \"slide-left menu\", \n  content: $(\"#infoWindowLayers\").get(0)\n});\nmap.addControl(infoWindowLayers);\n\nlet toc = document.getElementById('layers');\nLayerSwitcher.renderPanel(map, toc, { reverse: true });\n\nlet infoWindowSearch = new Overlay({ \n  closeBox : true, \n  className: \"slide-left menu\", \n  content: $(\"#infoWindowSearch\").get(0)\n});\nmap.addControl(infoWindowSearch);\n\nlet infoWindowFeature = new Overlay({ \n  closeBox : true, \n  className: \"slide-right info\", \n  content: $(\"#infoWindowFeature\").get(0)\n});\nmap.addControl(infoWindowFeature);\n\nlet menuBar = new Bar({\n  className: \"ol-top ol-left menuBar\"\n});\nmap.addControl(menuBar);\n\nlet nestedBar = new Bar({ toggleOne: true, group:true });\nmenuBar.addControl(nestedBar);\n\nlet logoBtn = new Button({ \n  html: '<img src=\"logo.png\" />',\n  className: \"logo\",\n  title: \"Castelldefels\",\n  handleClick: function() { \n    map.getView().setCenter(coordsInit);\n    map.getView().setZoom(zoomInit);\n  }\n});\nnestedBar.addControl(logoBtn);\n\nlet docsToggle = new Toggle({ \n  html: '<i class=\"fa fa-file-text-o\"></i>',\n  className: \"docs\",\n  title: \"Documents\",\n  onToggle: function() {\n    hideWindows(\"docs\");\n    infoWindowDocs.toggle();\n  }\n});\nnestedBar.addControl(docsToggle);\n\nlet layersToggle = new Toggle({ \n  html: '<i class=\"fa fa-align-justify\"></i>',\n  className: \"layers\",\n  title: \"Capas\",\n  onToggle: function() {\n    hideWindows(\"layers\");\n    infoWindowLayers.toggle();\n  }\n});\nnestedBar.addControl(layersToggle);\n\nlet searchToggle = new Toggle({ \n  html: '<i class=\"fa fa-search\"></i>',\n  className: \"search\",\n  title: \"Buscar\",\n  onToggle: function() {\n    hideWindows(\"search\");\n    infoWindowSearch.toggle();\n  }\n});\nnestedBar.addControl(searchToggle);\n\nfunction hideWindows(activeToggle) {\n  infoWindowDocs.hide();\n  infoWindowLayers.hide();\n  infoWindowSearch.hide();\n\n  if (activeToggle !== \"docs\")\n    docsToggle.setActive(false);\n  else if (activeToggle !== \"layers\")\n    layersToggle.setActive(false);\n  else if (activeToggle !== \"search\")\n    searchToggle.setActive(false);\n}\n\nlet whatsappBtn = new Button({ \n  html: '<i class=\"fa fa-whatsapp\" aria-hidden=\"true\"></i>',\n  className: \"whatsapp\",\n  title: \"Whatsapp\",\n  handleClick: function() { \n    \n  }\n});\nnestedBar.addControl(whatsappBtn);\n\nlet telegramBtn = new Button({ \n  html: '<i class=\"fa fa-telegram\" aria-hidden=\"true\"></i>',\n  className: \"telegram\",\n  title: \"Whatsapp\",\n  handleClick: function() { \n    \n  }\n});\nnestedBar.addControl(telegramBtn);\n\n$(\".window\").show();\n\n/*\n * Action buttons\n *****************************************/\nlet urlControl = new Permalink({ \n  urlReplace: true,\n  title: \"Compartir enllaç\"\n});\nmap.addControl(urlControl);\n\nlet geoloc = new GeolocationButton({\n  title: 'On estic?',\n  delay: 5000\n});\nmap.addControl(geoloc);\n\nlet here = new Popup({ positioning: 'bottom-center' });\nmap.addOverlay(here);\ngeoloc.on('position', function(e) {\n  if (e.coordinate) here.show(e.coordinate, \"Ets aquí!\");\n  else here.hide();\n});\n\n/*\n * Measure\n *****************************************/\nlet sketch,\n    helpTooltipElement,\n    helpTooltip,\n    measureTooltipElement,\n    measureTooltip,\n    continuePolygonMsg = 'Click per continuar dibuixant el polígon',\n    continueLineMsg = 'Click per continuar dibuixant la línea',\n    helpMsg = 'Clica per iniciar el dibuix',\n    draw,\n    measureActive = false;\n\nconst measureSource = new VectorSource();\nconst measureVector = new VectorLayer({\n  source: measureSource,\n  style: new Style({\n    fill: new Fill({\n      color: 'rgba(255, 255, 255, 0.2)',\n    }),\n    stroke: new Stroke({\n      color: '#ffcc33',\n      width: 2,\n    }),\n    image: new Circle({\n      radius: 7,\n      fill: new Fill({\n        color: '#ffcc33',\n      }),\n    }),\n  }),\n});\nmap.addLayer(measureVector);\n\nmap.on('pointermove', function(evt) {\n  if (measureActive) {\n    pointerMoveHandler(evt);\n  }\n  else {\n    // change mouse pointer over features\n    map.getTargetElement().style.cursor = map.hasFeatureAtPixel(map.getEventPixel(evt.originalEvent), { \n      hitTolerance: 5, \n      layerFilter: function (layer) {\n        return layer.get('name') === 'trams' || layer.get('name') === 'parcelles'\n      }\n    }) ? 'pointer' : '';\n  }\n});\n\n$(document).keyup(function(e) {\n  if (e.keyCode == 27) {\n    map.removeInteraction(draw);\n    map.removeOverlay(measureTooltip);\n    removeHelpTooltip();\n    $('.ol-tooltip').addClass('hidden');\n    measureToggle.toggle();\n    //measureSource.clear();\n  }\n});\n\nlet submeasureBar = new Bar({ \n  toggleOne: true,\n  autoDeactivate: true,\n  controls: [ \n    new Toggle({ \n      title: \"Medir distancia\",\n      //html:'<i class=\"fa fa-arrows-h\"></i>', \n      html: '<svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\"><g transform=\"translate(0 -8)\"><path d=\"m1.5000001 20.5h21v7h-21z\" style=\"overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square\"/><path d=\"m4.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m7.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m10.5 20v6\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m13.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m16.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m19.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m2.5 13v4\" fill=\"none\" stroke=\"#415a75\"/><path d=\"m21.5 13v4\" fill=\"none\" stroke=\"#415a75\"/><path d=\"m2 15h20\" fill=\"none\" stroke=\"#415a75\" stroke-width=\"1.99999988\"/></g></svg>',\n      //autoActivate: true,\n      onToggle: function(b) { \n        measureActive = b;\n        enableInteraction(b, true);\n      } \n    }),\n    new Toggle({ \n      title: \"Medir àrea\",\n      //html:'<i class=\"fa fa-arrows-alt\"></i>', \n      html: '<svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\"><g transform=\"translate(0 -8)\"><path d=\"m1.5000001 20.5h21v7h-21z\" style=\"overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square\"/><path d=\"m4.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m7.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m10.5 20v6\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m13.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m16.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m19.5 21v3\" fill=\"none\" stroke=\"#5b5b5c\"/><path d=\"m2.5 9.5h5v2h14v7.5h-6.5v-5h-5v3.5h-7.5z\" fill=\"#6d97c4\" fill-rule=\"evenodd\" stroke=\"#415a75\"/></g></svg>',\n      onToggle: function(b) { \n        measureActive = b;\n        enableInteraction(b, false);\n      }\n    })\n  ]\n});\nlet measureToggle = new Toggle({ \n  html: 'M',\n  bar: submeasureBar,\n  title: \"Medir\",\n  onToggle: function(b) {\n    if (!b) {\n      removeMeasure();\n      this.toggle();\n    }\n  }\n});\nlet measureBar = new Bar({ \n  autoDeactivate: true,\n  controls: [measureToggle],\n  className: \"ol-top ol-right measureBar\"\n});\nmap.addControl(measureBar);\n\nfunction enableInteraction(enable, distance) {\n  enable ? addInteraction(distance) : removeMeasure();\n}\n\nfunction addInteraction(distance) {\n  var type = (distance ? 'LineString' : 'Polygon');\n  draw = new Draw({\n    source: measureSource,\n    type: type,\n    style: new Style({\n      fill: new Fill({\n        color: 'rgba(255, 255, 255, 0.2)'\n      }),\n      stroke: new Stroke({\n        color: 'rgba(0, 0, 0, 0.5)',\n        lineDash: [10, 10],\n        width: 2\n      }),\n      image: new Circle({\n        radius: 5,\n        stroke: new Stroke({\n          color: 'rgba(0, 0, 0, 0.7)'\n        }),\n        fill: new Fill({\n          color: 'rgba(255, 255, 255, 0.2)'\n        })\n      })\n    })\n  });\n\n  map.addInteraction(draw);\n  createMeasureTooltip();\n  createHelpTooltip();\n\n  let listener;\n\n  draw.on('drawstart', function(evt) {\n    sketch = evt.feature;\n\n    var tooltipCoord = evt.coordinate;\n\n    listener = sketch.getGeometry().on('change', function(evt) {\n    var geom = evt.target;\n    var output;\n    if (geom instanceof Polygon) {\n      output = formatArea(geom);\n      tooltipCoord = geom.getInteriorPoint().getCoordinates();\n    } else if (geom instanceof LineString) {\n      output = formatLength(geom);\n      tooltipCoord = geom.getLastCoordinate();\n    }\n    measureTooltipElement.innerHTML = output;\n    measureTooltip.setPosition(tooltipCoord);\n    });\n  });\n\n  draw.on('drawend', function() {\n    measureTooltipElement.className = 'ol-tooltip ol-tooltip-static';\n    measureTooltip.setOffset([0, -7]);\n    sketch = null;\n    measureTooltipElement = null;\n    createMeasureTooltip();\n    unByKey(listener);\n  });\n}\n\nfunction removeMeasure() {\n  measureActive = false;\n  map.removeInteraction(draw);\n  map.removeOverlay(measureTooltip);\n  removeHelpTooltip();\n  $('.ol-tooltip').addClass('hidden');\n  measureToggle.toggle();\n  measureSource.clear();\n}\n\nfunction createHelpTooltip() {\n  removeHelpTooltip();\n  helpTooltipElement = document.createElement('div');\n  helpTooltipElement.className = 'ol-tooltip hidden';\n  helpTooltip = new OverlayOL({\n    element: helpTooltipElement,\n    offset: [15, 0],\n    positioning: 'center-left'\n  });\n  map.addOverlay(helpTooltip);\n\n  map.getViewport().addEventListener('mouseout', helpTooltipEventListener);\n}\n\nvar helpTooltipEventListener = function() {\n  helpTooltipElement.classList.add('hidden');\n}\n\nfunction removeHelpTooltip() {\n  map.removeOverlay(helpTooltip);\n  map.getViewport().removeEventListener('mouseout', helpTooltipEventListener);\n}\n\nfunction createMeasureTooltip() {\n  if (measureTooltipElement) {\n    measureTooltipElement.parentNode.removeChild(measureTooltipElement);\n  }\n  measureTooltipElement = document.createElement('div');\n  measureTooltipElement.className = 'ol-tooltip ol-tooltip-measure';\n  measureTooltip = new OverlayOL({\n    element: measureTooltipElement,\n    offset: [0, -15],\n    positioning: 'bottom-center',\n    stopEvent: false,\n    insertFirst: false,\n  });\n  map.addOverlay(measureTooltip);\n}\n\nvar pointerMoveHandler = function(evt) {\nif (evt.dragging) {\n  return;\n}\n\nif (sketch) {\n  var geom = (sketch.getGeometry());\n  if (geom instanceof Polygon) {\n    helpMsg = continuePolygonMsg;\n  } else if (geom instanceof LineString) {\n    helpMsg = continueLineMsg;\n  }\n}\n\n  if (helpTooltipElement && helpTooltipElement !== undefined) {\n    helpTooltipElement.innerHTML = helpMsg;\n    helpTooltip.setPosition(evt.coordinate);\n    helpTooltipElement.classList.remove('hidden');\n  }\n};\n\nvar formatLength = function(line) {\n  var length = getLength(line);\n  var output;\n  if (length > 100) {\n    output = (Math.round(length / 1000 * 100) / 100) + ' ' + 'km';\n  } \n  else {\n    output = (Math.round(length * 100) / 100) + ' ' + 'm';\n  }\n  return output;\n};  \n\nvar formatArea = function(polygon) {\n  var area = getArea(polygon);\n  var output;\n  if (area > 10000) {\n    output = (Math.round(area / 1000000 * 100) / 100) + ' ' + 'km<sup>2</sup>';\n  } \n  else {\n    output = (Math.round(area * 100) / 100) + ' ' + 'm<sup>2</sup>';\n  }\n  return output;\n};\n\n/*\n * Interaction\n *****************************************/\nlet select = new Select({ \n  layers: [tramsLayer, parcellesLayer],\n  hitTolerance: 5,\n  style: new Style({\n    stroke: new Stroke({\n      color: \"#ffff00\",\n      width: 5\n    })\n  })\n});\nmap.addInteraction(select);\n\n// On selected => show/hide popup\nselect.getFeatures().on('add', function(e) {\n  let feature = e.element,\n      layer = select.getLayer(feature).get('name'),\n      content = $(\"<div>\");\n\n  if (layer === \"trams\") {\n    content\n      .append( $(\"<p>\").text(\"eix_ncar: \" + feature.get(\"eix_ncar\")) )\n      .append( $(\"<p>\").text(\"observacions: \" + feature.get(\"observacions\")) )\n      .append( $(\"<p>\").text(\"estat: \" + feature.get(\"estat\")) )\n      .append( $(\"<p>\").text(\"data_inici_obres: \" + feature.get(\"data_inici_obres\")) )\n      .append( $(\"<p>\").text(\"data_fi_obres: \" + feature.get(\"data_fi_obres\")) );\n  }\n  else if (layer === \"parcelles\") {\n    content\n      .append( $(\"<p>\").text(\"refcat: \" + feature.get(\"refcat\")) )\n      .append( $(\"<p>\").text(\"residual: \" + feature.get(\"residual\")) )\n      .append( $(\"<p>\").text(\"conveni: \" + feature.get(\"conveni\")) );\n  }\n\n  $(\"#infoWindowFeature .content\").html(content);\n  infoWindowFeature.show();\n});\nselect.getFeatures().on('remove', function(e) { \n  $(\"#infoWindowFeature .content\").html(\"\");\n  infoWindowFeature.hide();\n});\n\nmap.on('click', function(evt) {\n  console.log(toLonLat(evt.coordinate));\n});"],"names":["defaultControls","Overlay","Bar","Button","Toggle","Permalink","GeolocationButton","Popup"],"mappings":"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"}