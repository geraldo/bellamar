import{f as ze,p as ue,r as He,T as S,O as Ze,a as We,b as W,G as de,V as x,c as L,d as _,S as w,e as f,F as T,M as Ye,g as Je,h as Ke,i as Ue,j as Xe,$ as e,k as t,t as $e,l as Qe,P as et,m as tt,I as ot,n as at,o as N,L as we,q as A,s as fe,u as b,v as rt,w as nt,x as lt,C as ge,D as it,y as pe,z as me,A as st,B as he,E as ct,H as ut,J as C}from"./vendor.b9b82a5d.js";const dt=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function l(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(r){if(r.ep)return;r.ep=!0;const i=l(r);fetch(r.href,i)}};dt();const be=16,ve=ze([1.957,41.271]),wt="https://mapa.psig.es/mapproxy/service",Y="https://mapa.psig.es/qgisserver/wfs3/collections/",J="/items.geojson",P="?MAP=/home/ubuntu/bellamar/Obra_Bellamar_web.qgs",K="&limit=10000";let U,X,B,F,D,j,ye,R,M,$,Q,O,G;ue.defs("EPSG:25831","+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");He(ue);let xe=new S({title:"Ning\xFA",type:"base",source:null,visible:!1}),Le=new S({title:"OpenStreetMap",type:"base",visible:!1,source:new Ze}),Te=new S({title:"Ortofoto hist\xF2rica de 2020 (AMB)",type:"base",visible:!1,source:new We({url:"https://geoportal.amb.cat/geoserveis/rest/services/ortofoto_territorial_10cm_2020_25831/MapServer",projection:"EPSG:25831",params:{LAYERS:"Orto2020_10cm"},attributions:['\xA9 <a target="_blank" href="https://www.amb.cat/">AMB</a>']})}),Ce=new S({title:"Topogr\xE1fic (ICGC)",type:"base",visible:!0,maxZoom:18,source:new W({url:"https://geoserveis.icgc.cat/icc_mapesmultibase/utm/wms/service?",params:{LAYERS:"topogris",VERSION:"1.1.1"},attributions:['Cartografia topogr\xE0fica 1:1.000 de l\u2019<a target="_blank" href="https://www.icgc.cat/">Institut Cartogr\xE0fic i Geol\xF2gic de Catalunya (ICGC)</a>, sota una llic\xE8ncia <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/deed.ca">CC BY 4.0</a>']})}),ke=new de({title:"Mapes base",layers:[xe,Le,Te,Ce]}),Se=new S({title:"Topografia completa",visible:!0,minZoom:18,source:new W({url:wt+P,params:{LAYERS:"bellamar_topografia",TRANSPARENT:!0,VERSION:"1.3.0"},serverType:"qgis"})}),_e=new S({title:"Catastro",visible:!1,source:new W({url:"https://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx",params:{LAYERS:"catastro",TILED:!0,SRS:"EPSG:3857"}})}),Ne=new x({title:"Pluvial",visible:!0,source:new L({format:new _,url:Y+"bellamar_pluvial"+J+P+K}),style:new w({stroke:new f({lineDash:[10,5],color:"#1f78b4",width:3})})}),ee=new x({title:"Trams de les obres",name:"trams",visible:!0,source:new L({format:new _,url:Y+"Trams de les obres"+J+P+K}),style:function(o,a){let l=o.get("estat");return l==="finalitzat"?new w({stroke:new f({color:"rgba(9,222,0,0.8)",width:4})}):l==="en obra"?new w({stroke:new f({color:"rgba(219,30,42,0.8)",width:4})}):l==="inici en breu"?new w({stroke:new f({color:"rgba(255,140,0,0.8)",width:4})}):l==="pendent"?new w({stroke:new f({color:"rgba(0,118,182,0.8)",width:4})}):l==="excl\xF2s"?new w({stroke:new f({color:"rgba(146,147,151,0.5)",width:3})}):new w({stroke:new f({color:"rgba(255,255,0,0.5)",width:2})})}}),te=new x({title:"Parcel\xB7les projecte Bellamar",name:"parcelles",visible:!0,source:new L({format:new _,url:Y+"Parcel\xB7les projecte Bellamar"+J+P+K}),style:function(o,a){return o.get("residual")==="No"?new w({fill:new T({color:"rgba(196,154,151,0.4)"})}):o.get("residual")==="S\xED"?new w({fill:new T({color:"rgba(135,105,100,0.4)"})}):null}}),Ae=new x({title:"Barris",visible:!0,source:new L({format:new _,url:"barris.geojson"}),style:new w({stroke:new f({color:"#000",width:2})})});const n=new Ye({target:"map",controls:Je().extend([new Ke]),layers:new de({fold:"close",layers:[ke,_e,Se,Ae,Ne,ee,te]}),view:new Ue({center:ve,zoom:be,minZoom:14,maxZoom:20})});function ft(){O=new N({closeBox:!0,className:"slide-left menu",content:e("#windowDocs").get(0)}),n.addControl(O);let o=new N({closeBox:!0,className:"slide-left menu",content:e("#windowLayers").get(0)});n.addControl(o),we.renderPanel(n,document.getElementById("layerSwitcher"),{reverse:!0});let a=new N({closeBox:!0,className:"slide-left menu",content:e("#windowSearch").get(0)});n.addControl(a);let l=new N({closeBox:!0,className:"slide-left menu",content:e("#windowApp").get(0)});n.addControl(l),G=new N({closeBox:!0,className:"slide-right info",content:e("#windowFeature").get(0)}),n.addControl(G);let c=new A({className:"ol-top ol-left menuBar"});n.addControl(c);let r=new A({toggleOne:!0,group:!0});c.addControl(r);let i=new fe({html:'<img src="logo.png" />',className:"logo",title:"Castelldefels",handleClick:function(){n.getView().setCenter(ve),n.getView().setZoom(be)}});r.addControl(i),B=new b({html:'<i class="fa fa-file-text-o"></i>',className:"docsToggle",onToggle:function(){u("docs"),O.toggle()}}),r.addControl(B),F=new b({html:'<i class="fa fa-align-justify"></i>',className:"layersToggle",onToggle:function(){u("layers"),o.toggle()}}),r.addControl(F),D=new b({html:'<i class="fa fa-search"></i>',className:"searchToggle",onToggle:function(){u("search"),a.toggle()}}),r.addControl(D);function u(g){O.hide(),o.hide(),a.hide(),l.hide(),g!=="docs"?B.setActive(!1):g!=="layers"?F.setActive(!1):g!=="search"?D.setActive(!1):g!=="app"&&j.setActive(!1)}let p=new fe({html:'<img src="https://www.castelldefels.org/A_Comuns/_Pells/_Comu/Img/Xarxes/twitter.png" alt="twitter" width="20" height="20">',className:"twitter",title:"Twitter",handleClick:function(){window.open("https://twitter.com/hashtag/ObresBellamarCastelldefels","_blank").focus()}});r.addControl(p),j=new b({html:'<img src="https://w2.m7citizensecurity.com/wp-content/uploads/2021/07/cropped-LogoM7_peq-32x32.jpg" alt="M7 app" width="20" height="20">',className:"appToggle",onToggle:function(){u("app"),l.toggle()}}),r.addControl(j);let h=new A({toggleOne:!0,group:!0});c.addControl(h),U=new b({html:"CA",className:"lang ca",title:"Catal\xE0",onToggle:function(){t.changeLanguage("ca")}}),h.addControl(U),X=new b({html:"ES",className:"lang es",title:"Castellano",onToggle:function(){t.changeLanguage("es")}}),h.addControl(X),e(".window").show()}function gt(){ye=new rt({urlReplace:!0}),n.addControl(ye),R=new nt({delay:5e3}),n.addControl(R);let o=new lt({positioning:"bottom-center"});n.addOverlay(o),R.on("position",function(s){s.coordinate?o.show(s.coordinate,"Ets aqu\xED!"):o.hide()});let a,l,c,r,i,u="Click per continuar dibuixant el pol\xEDgon",p="Click per continuar dibuixant la l\xEDnea",h="Clica per iniciar el dibuix",g,I=!1;const V=new L,Ie=new x({source:V,style:new w({fill:new T({color:"rgba(255, 255, 255, 0.2)"}),stroke:new f({color:"#ffcc33",width:2}),image:new ge({radius:7,fill:new T({color:"#ffcc33"})})})});n.addLayer(Ie),n.on("pointermove",function(s){I?Re(s):n.getTargetElement().style.cursor=n.hasFeatureAtPixel(n.getEventPixel(s.originalEvent),{hitTolerance:5,layerFilter:function(d){return d.get("name")==="trams"||d.get("name")==="parcelles"}})?"pointer":""}),e(document).keyup(function(s){s.keyCode==27&&(n.removeInteraction(g),n.removeOverlay(i),z(),e(".ol-tooltip").addClass("hidden"),M.toggle())}),$=new b({html:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="https://www.w3.org/2000/svg"><g transform="translate(0 -8)"><path d="m1.5000001 20.5h21v7h-21z" style="overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square"/><path d="m4.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m7.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m10.5 20v6" fill="none" stroke="#5b5b5c"/><path d="m13.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m16.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m19.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m2.5 13v4" fill="none" stroke="#415a75"/><path d="m21.5 13v4" fill="none" stroke="#415a75"/><path d="m2 15h20" fill="none" stroke="#415a75" stroke-width="1.99999988"/></g></svg>',onToggle:function(s){I=s,ne(s,!0)}}),Q=new b({html:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="https://www.w3.org/2000/svg"><g transform="translate(0 -8)"><path d="m1.5000001 20.5h21v7h-21z" style="overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square"/><path d="m4.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m7.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m10.5 20v6" fill="none" stroke="#5b5b5c"/><path d="m13.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m16.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m19.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m2.5 9.5h5v2h14v7.5h-6.5v-5h-5v3.5h-7.5z" fill="#6d97c4" fill-rule="evenodd" stroke="#415a75"/></g></svg>',onToggle:function(s){I=s,ne(s,!1)}});let Pe=new A({toggleOne:!0,autoDeactivate:!0,controls:[$,Q]});M=new b({html:"M",bar:Pe,onToggle:function(s){s||(le(),this.toggle())}});let Fe=new A({autoDeactivate:!0,controls:[M],className:"ol-top ol-right measureBar"});n.addControl(Fe);function ne(s,d){s?De(d):le()}function De(s){var d=s?"LineString":"Polygon";g=new it({source:V,type:d,style:new w({fill:new T({color:"rgba(255, 255, 255, 0.2)"}),stroke:new f({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ge({radius:5,stroke:new f({color:"rgba(0, 0, 0, 0.7)"}),fill:new T({color:"rgba(255, 255, 255, 0.2)"})})})}),n.addInteraction(g),se(),je();let m;g.on("drawstart",function(ce){a=ce.feature;var H=ce.coordinate;m=a.getGeometry().on("change",function(Ve){var k=Ve.target,Z;k instanceof pe?(Z=qe(k),H=k.getInteriorPoint().getCoordinates()):k instanceof me&&(Z=Ge(k),H=k.getLastCoordinate()),r.innerHTML=Z,i.setPosition(H)})}),g.on("drawend",function(){r.className="ol-tooltip ol-tooltip-static",i.setOffset([0,-7]),a=null,r=null,se(),st(m)})}function le(){I=!1,n.removeInteraction(g),n.removeOverlay(i),z(),e(".ol-tooltip").addClass("hidden"),M.toggle(),V.clear()}function je(){z(),l=document.createElement("div"),l.className="ol-tooltip hidden",c=new he({element:l,offset:[15,0],positioning:"center-left"}),n.addOverlay(c),n.getViewport().addEventListener("mouseout",ie)}var ie=function(){l.classList.add("hidden")};function z(){n.removeOverlay(c),n.getViewport().removeEventListener("mouseout",ie)}function se(){r&&r.parentNode.removeChild(r),r=document.createElement("div"),r.className="ol-tooltip ol-tooltip-measure",i=new he({element:r,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),n.addOverlay(i)}var Re=function(s){if(!s.dragging){if(a){var d=a.getGeometry();d instanceof pe?h=u:d instanceof me&&(h=p)}l&&l!==void 0&&(l.innerHTML=h,c.setPosition(s.coordinate),l.classList.remove("hidden"))}},Ge=function(s){var d=ct(s),m;return d>100?m=Math.round(d/1e3*100)/100+" km":m=Math.round(d*100)/100+" m",m},qe=function(s){var d=ut(s),m;return d>1e4?m=Math.round(d/1e6*100)/100+" km<sup>2</sup>":m=Math.round(d*100)/100+" m<sup>2</sup>",m}}let Be=new w({stroke:new f({color:"#ffff00",width:5}),fill:new T({color:"rgba(255,255,0,0.3)"})}),q=new Xe({layers:[ee,te],hitTolerance:5,style:Be});n.addInteraction(q);q.getFeatures().on("add",function(o){let a=o.element,l=q.getLayer(a).get("name"),c=e("<div>");l==="trams"?c.append(v(a,"eix_ncar")).append(v(a,"observacions")).append(v(a,"estat")).append(v(a,"data_inici_obres")).append(v(a,"data_fi_obres")):l==="parcelles"&&c.append(v(a,"refcat")).append(v(a,"residual")).append(v(a,"conveni")),e("#windowFeature .content").html(c),G.show()});q.getFeatures().on("remove",function(o){e("#windowFeature .content").html(""),G.hide()});function v(o,a){let l=o.get(a);return a==="estat"&&(l=t.t("feature."+l)),l===null?"":e("<p>").html("<span class='label "+a+"'>"+t.t("feature."+a)+"</span>: "+l)}e.get("./carrers.txt",function(o){let a=o.split(`,
`),l=a.length;e("#searchCarrer").keyup(function(r){document.getElementById("carrerList").innerHTML="",e("#searchNumero").empty();for(let i=0;i<l;i++){let u=a[i].split(",");if(u[1].toLowerCase().indexOf(e("#searchCarrer").val().toLowerCase())>-1){let p=document.createElement("option"),h=document.createTextNode(u[1]);document.createAttribute("value"),p.appendChild(h),p.setAttribute("data-id",u[0]),document.getElementById("carrerList").appendChild(p)}}}),e("#searchCarrer").on("input",function(r){e("#searchMsg").text("");let i=this.value,u=-1;e("#carrerList option").filter(function(){return this.value===i&&(u=this.dataset.id),this.value===i}).length&&c(u)});function c(r){r&&r!==""&&r!==-1&&e.ajax({url:"./ajaxfile.php",type:"post",data:{request:"carrersNum",carrer:r},dataType:"json",success:function(i){if(i.length>0){e("#searchNumero").empty(),e("#searchNumero").append('<option value="-1">'+t.t("search.searchOption")+"</option>");for(let u in i){let p=JSON.parse(i[u].geom);e("#searchNumero").append('<option data-x="'+p.coordinates[0][0]+'" data-y="'+p.coordinates[0][1]+'">'+i[u].npol_num1+"</option>")}}else e("#searchMsg").text("No ha hi cap n\xFAmero de aquest carrer.")}})}});e("#searchNumero").on("change",function(){var o=Number(this.options[this.selectedIndex].getAttribute("data-x")),a=Number(this.options[this.selectedIndex].getAttribute("data-y"));return Oe(o)&&Oe(a)&&(Me(o,a,!1),mt([o,a])),!1});e("#searchReferenciaBtn").click(function(){e("#searchMsg").text(""),y!==null&&y.clear();let o=e("#searchReferencia").val().trim();o&&o!==""&&e.ajax({url:"./ajaxfile.php",type:"post",data:{request:"catasterGeom",refcat:o},dataType:"json",success:function(a){a.length>0?(Me(a[0].coorx,a[0].coory,!0),pt(a[0].geom)):e("#searchMsg").text("No ha hi cap parcela amb aquesta refer\xE8ncia cadastral.")}})});function Me(o,a,l=!1){console.log("zoomToCoord:"+o+":"+a);let c=[o,a];l&&(c=$e([o,a],Qe("EPSG:25831"),"EPSG:3857")),n.getView().animate({zoom:n.getView().getZoom()+1,center:c,duration:2e3})}let oe=null,y=null;function pt(o){o&&(oe===null?(y=new L({features:new _().readFeatures(o)}),oe=new x({source:y,style:Be}),n.addLayer(oe)):(y.clear(),y.addFeatures(new _().readFeatures(o))))}let E=null,ae=null;function mt(o){console.log("showIcon:"+o[0]+":"+o[1]),E===null?(ae=new et(o),E=new x({source:new L({features:[new tt({geometry:ae})]}),style:new w({image:new ot({anchor:[.5,0],anchorOrigin:"bottom-left",color:[255,0,0,1],src:"./marker.png"})})}),n.addLayer(E)):ae.setCoordinates(o)}function Oe(o){return!isNaN(parseFloat(o))&&isFinite(o)}n.on("click",function(o){y!==null&&y.clear(),n.removeLayer(E),E=null,console.log(at(o.coordinate))});const re={sameSite:"strict",secure:!0};function ht(){C.get("showinfo")===void 0||C.get("showinfo")==="true"?(B.setActive(!0),O.show()):e("#showinfo").prop("checked",!0),e("#showinfo").change(function(){C.set("showinfo",!this.checked,re)}),e.ajax({url:"./translations.json",dataType:"json",success:function(o){let a=bt();t.init({lng:a,debug:!0,resources:o}).then(function(l){Ee(),t.on("languageChanged",()=>{C.set("lang",t.language,re),Ee()})})}})}function bt(){let o="ca";return C.get("lang")===void 0?C.set("lang",o,re):o=C.get("lang"),o==="es"?X.setActive(!0):U.setActive(!0),o}function Ee(){console.log("translate"),B.setTitle(t.t("gui.windowDocsTitle")),F.setTitle(t.t("gui.windowLayersTitle")),D.setTitle(t.t("gui.windowSearchTitle")),j.setTitle(t.t("gui.windowAppTitle")),e("#windowDocs .text").text(t.t("gui.windowDocsText")),e("#windowDocs .text_whatsapp").text(t.t("gui.windowDocsTextWhatsapp")),e("#windowDocs .text_app").text(t.t("gui.windowDocsTextApp")),e("#windowApp .text_app").text(t.t("gui.windowDocsTextApp")),e("#windowDocs .text_app_label").text(t.t("gui.windowDocsTextAppLabel")),e("#windowApp .text_app_label").text(t.t("gui.windowDocsTextAppLabel")),e("#windowDocs .info label").text(t.t("gui.windowDocsShowInfo")),e("#windowSearch .titleCarrer").text(t.t("search.titleCarrer")),e("#windowSearch .labelCarrer").text(t.t("search.labelCarrer")),e("#windowSearch .labelNumero").text(t.t("search.labelNumero")),e("#windowSearch #searchOption").text(t.t("search.searchOption")),e("#windowSearch .titleCatastro").text(t.t("search.titleCatastro")),e("#windowSearch .introCatastro").text(t.t("search.introCatastro")),e("#windowSearch .labelReferencia").text(t.t("search.labelReferencia")),e("#windowSearch .btnReferencia").text(t.t("search.btnReferencia")),e(".ol-permalink button").attr("title",t.t("gui.urlmsg")),R.setTitle(t.t("gui.geopos")),M.setTitle(t.t("gui.measure")),$.setTitle(t.t("gui.measureDistance")),Q.setTitle(t.t("gui.measureArea")),e(".ol-attribution button").attr("title",t.t("gui.attribution")),e("#windowDocs .title").text(t.t("gui.windowDocsTitle")),e("#windowLayers .title").text(t.t("gui.windowLayersTitle")),e("#windowSearch .title").text(t.t("gui.windowSearchTitle")),e("#windowApp .title").text(t.t("gui.windowAppTitle")),e("#windowFeature .title").text(t.t("gui.windowFeatureTitle")),e("#windowFeature .label.eix_ncar").text(t.t("feature.eix_ncar")),e("#windowFeature .label.observacions").text(t.t("feature.observacions")),e("#windowFeature .label.estat").text(t.t("feature.estat")),e("#windowFeature .label.data_inici_obres").text(t.t("feature.data_inici_obres")),e("#windowFeature .label.data_fi_obres").text(t.t("feature.data_fi_obres")),e("#windowFeature .label.refcat").text(t.t("feature.refcat")),e("#windowFeature .label.residual").text(t.t("feature.residual")),e("#windowFeature .label.conveni").text(t.t("feature.conveni")),te.set("title",t.t("switcher.parcellesLayer")),ee.set("title",t.t("switcher.tramsLayer")),Ne.set("title",t.t("switcher.pluvialLayer")),Ae.set("title",t.t("switcher.barrisLayer")),Se.set("title",t.t("switcher.topoLayer")),_e.set("title",t.t("switcher.catastroLayer")),ke.set("title",t.t("switcher.baseLayers")),Ce.set("title",t.t("switcher.topoBaseLayer")),Te.set("title",t.t("switcher.ortoLayer")),Le.set("title",t.t("switcher.osmLayer")),xe.set("title",t.t("switcher.ninguLayer")),we.renderPanel(n,document.getElementById("layerSwitcher"),{reverse:!0})}e(function(){ft(),gt(),ht()});
//# sourceMappingURL=index.081e6ea0.js.map
