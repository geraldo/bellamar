import{f as qe,p as ue,r as ze,T as S,O as He,a as Ze,b as W,G as de,V as L,c as x,d as _,S as f,e as g,F as T,M as We,g as Ye,h as Je,i as Xe,j as Ke,$ as e,k as a,t as Ue,l as $e,P as Qe,m as et,I as tt,n as at,o as P,L as fe,q as B,s as I,u as b,v as ot,w as rt,x as nt,C as ge,D as lt,y as we,z as me,A as it,B as he,E as st,H as ct,J as N}from"./vendor.b9b82a5d.js";const ut=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function i(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(n){if(n.ep)return;n.ep=!0;const l=i(n);fetch(n.href,l)}};ut();const pe=16,be=qe([1.957,41.271]),dt="https://mapa.psig.es/mapproxy/service",Y="https://mapa.psig.es/qgisserver/wfs3/collections/",J="/items.geojson",F="?MAP=/home/ubuntu/bellamar/Obra_Bellamar_web.qgs",X="&limit=10000";let K,U,O,j,R,ve,G,E,$,Q,M,D;ue.defs("EPSG:25831","+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");ze(ue);let ye=new S({title:"Ning\xFA",type:"base",source:null,visible:!1}),Ce=new S({title:"OpenStreetMap",type:"base",visible:!1,source:new He}),Le=new S({title:"Ortofoto hist\xF2rica de 2020 (AMB)",type:"base",visible:!1,source:new Ze({url:"https://geoportal.amb.cat/geoserveis/rest/services/ortofoto_territorial_10cm_2020_25831/MapServer",projection:"EPSG:25831",params:{LAYERS:"Orto2020_10cm"},attributions:['\xA9 <a target="_blank" href="https://www.amb.cat/">AMB</a>']})}),xe=new S({title:"Topogr\xE1fic (ICGC)",type:"base",visible:!0,maxZoom:18,source:new W({url:"https://geoserveis.icgc.cat/icc_mapesmultibase/utm/wms/service?",params:{LAYERS:"topogris",VERSION:"1.1.1"},attributions:['Cartografia topogr\xE0fica 1:1.000 de l\u2019<a target="_blank" href="https://www.icgc.cat/">Institut Cartogr\xE0fic i Geol\xF2gic de Catalunya (ICGC)</a>, sota una llic\xE8ncia <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/deed.ca">CC BY 4.0</a>']})}),Te=new de({title:"Mapes base",layers:[ye,Ce,Le,xe]}),ke=new S({title:"Topografia completa",visible:!0,minZoom:18,source:new W({url:dt+F,params:{LAYERS:"bellamar_topografia",TRANSPARENT:!0,VERSION:"1.3.0"},serverType:"qgis"})}),Se=new S({title:"Catastro",visible:!1,source:new W({url:"https://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx",params:{LAYERS:"catastro",TILED:!0,SRS:"EPSG:3857"}})}),_e=new L({title:"Pluvial",visible:!0,source:new x({format:new _,url:Y+"bellamar_pluvial"+J+F+X}),style:new f({stroke:new g({lineDash:[10,5],color:"#1f78b4",width:3})})}),ee=new L({title:"Trams de les obres",name:"trams",visible:!0,source:new x({format:new _,url:Y+"Trams de les obres"+J+F+X}),style:function(t,o){let i=t.get("estat");return i==="finalitzat"?new f({stroke:new g({color:"rgba(9,222,0,0.8)",width:4})}):i==="en obra"?new f({stroke:new g({color:"rgba(219,30,42,0.8)",width:4})}):i==="inici en breu"?new f({stroke:new g({color:"rgba(255,140,0,0.8)",width:4})}):i==="pendent"?new f({stroke:new g({color:"rgba(0,118,182,0.8)",width:4})}):i==="excl\xF2s"?new f({stroke:new g({color:"rgba(146,147,151,0.5)",width:3})}):new f({stroke:new g({color:"rgba(255,255,0,0.5)",width:2})})}}),te=new L({title:"Parcel\xB7les projecte Bellamar",name:"parcelles",visible:!0,source:new x({format:new _,url:Y+"Parcel\xB7les projecte Bellamar"+J+F+X}),style:function(t,o){return t.get("residual")==="No"?new f({fill:new T({color:"rgba(196,154,151,0.4)"})}):t.get("residual")==="S\xED"?new f({fill:new T({color:"rgba(135,105,100,0.4)"})}):null}}),Ne=new L({title:"Barris",visible:!0,source:new x({format:new _,url:"barris.geojson"}),style:new f({stroke:new g({color:"#000",width:2})})});const r=new We({target:"map",controls:Ye().extend([new Je]),layers:new de({fold:"close",layers:[Te,Se,ke,Ne,_e,ee,te]}),view:new Xe({center:be,zoom:pe,minZoom:14,maxZoom:20})});function ft(){M=new P({closeBox:!0,className:"slide-left menu",content:e("#windowDocs").get(0)}),r.addControl(M);let t=new P({closeBox:!0,className:"slide-left menu",content:e("#windowLayers").get(0)});r.addControl(t),fe.renderPanel(r,document.getElementById("layerSwitcher"),{reverse:!0});let o=new P({closeBox:!0,className:"slide-left menu",content:e("#windowSearch").get(0)});r.addControl(o),D=new P({closeBox:!0,className:"slide-right info",content:e("#windowFeature").get(0)}),r.addControl(D);let i=new B({className:"ol-top ol-left menuBar"});r.addControl(i);let c=new B({toggleOne:!0,group:!0});i.addControl(c);let n=new I({html:'<img src="logo.png" />',className:"logo",title:"Castelldefels",handleClick:function(){r.getView().setCenter(be),r.getView().setZoom(pe)}});c.addControl(n),O=new b({html:'<i class="fa fa-file-text-o"></i>',className:"docsToggle",onToggle:function(){l("docs"),M.toggle()}}),c.addControl(O),j=new b({html:'<i class="fa fa-align-justify"></i>',className:"layersToggle",onToggle:function(){l("layers"),t.toggle()}}),c.addControl(j),R=new b({html:'<i class="fa fa-search"></i>',className:"searchToggle",onToggle:function(){l("search"),o.toggle()}}),c.addControl(R);function l(p){M.hide(),t.hide(),o.hide(),p!=="docs"?O.setActive(!1):p!=="layers"?j.setActive(!1):p!=="search"&&R.setActive(!1)}let u=new I({html:'<img src="https://www.castelldefels.org/A_Comuns/_Pells/_Comu/Img/Xarxes/twitter.png" alt="twitter" width="20" height="20">',className:"twitter",title:"Twitter",handleClick:function(){window.open("https://twitter.com/AjCastelldefels","_blank").focus()}});c.addControl(u);let w=new I({html:'<img src="https://www.castelldefels.org/A_Comuns/_Pells/_Comu/Img/Xarxes/whatsapp.png" alt="whatsapp" width="20" height="20">',className:"whatsapp",title:"Whatsapp",handleClick:function(){}});c.addControl(w);let C=new I({html:'<img src="https://www.castelldefels.org/A_Comuns/_Pells/_Comu/Img/Xarxes/telegram.png" alt="telegram" width="20" height="20">',className:"telegram",title:"Telegram",handleClick:function(){}});c.addControl(C);let m=new B({toggleOne:!0,group:!0});i.addControl(m),K=new b({html:"CA",className:"lang ca",title:"Catal\xE0",onToggle:function(){a.changeLanguage("ca")}}),m.addControl(K),U=new b({html:"ES",className:"lang es",title:"Castellano",onToggle:function(){a.changeLanguage("es")}}),m.addControl(U),e(".window").show()}function gt(){ve=new ot({urlReplace:!0}),r.addControl(ve),G=new rt({delay:5e3}),r.addControl(G);let t=new nt({positioning:"bottom-center"});r.addOverlay(t),G.on("position",function(s){s.coordinate?t.show(s.coordinate,"Ets aqu\xED!"):t.hide()});let o,i,c,n,l,u="Click per continuar dibuixant el pol\xEDgon",w="Click per continuar dibuixant la l\xEDnea",C="Clica per iniciar el dibuix",m,p=!1;const q=new x,Ae=new L({source:q,style:new f({fill:new T({color:"rgba(255, 255, 255, 0.2)"}),stroke:new g({color:"#ffcc33",width:2}),image:new ge({radius:7,fill:new T({color:"#ffcc33"})})})});r.addLayer(Ae),r.on("pointermove",function(s){p?Re(s):r.getTargetElement().style.cursor=r.hasFeatureAtPixel(r.getEventPixel(s.originalEvent),{hitTolerance:5,layerFilter:function(d){return d.get("name")==="trams"||d.get("name")==="parcelles"}})?"pointer":""}),e(document).keyup(function(s){s.keyCode==27&&(r.removeInteraction(m),r.removeOverlay(l),z(),e(".ol-tooltip").addClass("hidden"),E.toggle())}),$=new b({html:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="https://www.w3.org/2000/svg"><g transform="translate(0 -8)"><path d="m1.5000001 20.5h21v7h-21z" style="overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square"/><path d="m4.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m7.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m10.5 20v6" fill="none" stroke="#5b5b5c"/><path d="m13.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m16.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m19.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m2.5 13v4" fill="none" stroke="#415a75"/><path d="m21.5 13v4" fill="none" stroke="#415a75"/><path d="m2 15h20" fill="none" stroke="#415a75" stroke-width="1.99999988"/></g></svg>',onToggle:function(s){p=s,ne(s,!0)}}),Q=new b({html:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="https://www.w3.org/2000/svg"><g transform="translate(0 -8)"><path d="m1.5000001 20.5h21v7h-21z" style="overflow:visible;fill:#c7c7c7;fill-rule:evenodd;stroke:#5b5b5c;stroke-width:.99999994;stroke-linecap:square"/><path d="m4.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m7.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m10.5 20v6" fill="none" stroke="#5b5b5c"/><path d="m13.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m16.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m19.5 21v3" fill="none" stroke="#5b5b5c"/><path d="m2.5 9.5h5v2h14v7.5h-6.5v-5h-5v3.5h-7.5z" fill="#6d97c4" fill-rule="evenodd" stroke="#415a75"/></g></svg>',onToggle:function(s){p=s,ne(s,!1)}});let Pe=new B({toggleOne:!0,autoDeactivate:!0,controls:[$,Q]});E=new b({html:"M",bar:Pe,onToggle:function(s){s||(le(),this.toggle())}});let Ie=new B({autoDeactivate:!0,controls:[E],className:"ol-top ol-right measureBar"});r.addControl(Ie);function ne(s,d){s?Fe(d):le()}function Fe(s){var d=s?"LineString":"Polygon";m=new lt({source:q,type:d,style:new f({fill:new T({color:"rgba(255, 255, 255, 0.2)"}),stroke:new g({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ge({radius:5,stroke:new g({color:"rgba(0, 0, 0, 0.7)"}),fill:new T({color:"rgba(255, 255, 255, 0.2)"})})})}),r.addInteraction(m),se(),je();let h;m.on("drawstart",function(ce){o=ce.feature;var H=ce.coordinate;h=o.getGeometry().on("change",function(Ve){var k=Ve.target,Z;k instanceof we?(Z=De(k),H=k.getInteriorPoint().getCoordinates()):k instanceof me&&(Z=Ge(k),H=k.getLastCoordinate()),n.innerHTML=Z,l.setPosition(H)})}),m.on("drawend",function(){n.className="ol-tooltip ol-tooltip-static",l.setOffset([0,-7]),o=null,n=null,se(),it(h)})}function le(){p=!1,r.removeInteraction(m),r.removeOverlay(l),z(),e(".ol-tooltip").addClass("hidden"),E.toggle(),q.clear()}function je(){z(),i=document.createElement("div"),i.className="ol-tooltip hidden",c=new he({element:i,offset:[15,0],positioning:"center-left"}),r.addOverlay(c),r.getViewport().addEventListener("mouseout",ie)}var ie=function(){i.classList.add("hidden")};function z(){r.removeOverlay(c),r.getViewport().removeEventListener("mouseout",ie)}function se(){n&&n.parentNode.removeChild(n),n=document.createElement("div"),n.className="ol-tooltip ol-tooltip-measure",l=new he({element:n,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),r.addOverlay(l)}var Re=function(s){if(!s.dragging){if(o){var d=o.getGeometry();d instanceof we?C=u:d instanceof me&&(C=w)}i&&i!==void 0&&(i.innerHTML=C,c.setPosition(s.coordinate),i.classList.remove("hidden"))}},Ge=function(s){var d=st(s),h;return d>100?h=Math.round(d/1e3*100)/100+" km":h=Math.round(d*100)/100+" m",h},De=function(s){var d=ct(s),h;return d>1e4?h=Math.round(d/1e6*100)/100+" km<sup>2</sup>":h=Math.round(d*100)/100+" m<sup>2</sup>",h}}let Be=new f({stroke:new g({color:"#ffff00",width:5}),fill:new T({color:"rgba(255,255,0,0.3)"})}),V=new Ke({layers:[ee,te],hitTolerance:5,style:Be});r.addInteraction(V);V.getFeatures().on("add",function(t){let o=t.element,i=V.getLayer(o).get("name"),c=e("<div>");i==="trams"?c.append(v(o,"eix_ncar")).append(v(o,"observacions")).append(v(o,"estat")).append(v(o,"data_inici_obres")).append(v(o,"data_fi_obres")):i==="parcelles"&&c.append(v(o,"refcat")).append(v(o,"residual")).append(v(o,"conveni")),e("#windowFeature .content").html(c),D.show()});V.getFeatures().on("remove",function(t){e("#windowFeature .content").html(""),D.hide()});function v(t,o){let i=t.get(o);return o==="estat"&&(i=a.t("feature."+i)),i===null?"":e("<p>").html("<span class='label "+o+"'>"+a.t("feature."+o)+"</span>: "+i)}e.get("./carrers.txt",function(t){let o=t.split(`,
`),i=o.length;e("#searchCarrer").keyup(function(n){document.getElementById("carrerList").innerHTML="",e("#searchNumero").empty();for(let l=0;l<i;l++){let u=o[l].split(",");if(u[1].toLowerCase().indexOf(e("#searchCarrer").val().toLowerCase())>-1){let w=document.createElement("option"),C=document.createTextNode(u[1]);document.createAttribute("value"),w.appendChild(C),w.setAttribute("data-id",u[0]),document.getElementById("carrerList").appendChild(w)}}}),e("#searchCarrer").on("input",function(n){e("#searchMsg").text("");let l=this.value,u=-1;e("#carrerList option").filter(function(){return this.value===l&&(u=this.dataset.id),this.value===l}).length&&c(u)});function c(n){n&&n!==""&&n!==-1&&e.ajax({url:"./ajaxfile.php",type:"post",data:{request:"carrersNum",carrer:n},dataType:"json",success:function(l){if(l.length>0){e("#searchNumero").empty(),e("#searchNumero").append('<option value="-1">'+a.t("search.searchOption")+"</option>");for(let u in l){let w=JSON.parse(l[u].geom);e("#searchNumero").append('<option data-x="'+w.coordinates[0][0]+'" data-y="'+w.coordinates[0][1]+'">'+l[u].npol_num1+"</option>")}}else e("#searchMsg").text("No ha hi cap n\xFAmero de aquest carrer.")}})}});e("#searchNumero").on("change",function(){var t=Number(this.options[this.selectedIndex].getAttribute("data-x")),o=Number(this.options[this.selectedIndex].getAttribute("data-y"));return Ee(t)&&Ee(o)&&(Oe(t,o,!1),mt([t,o])),!1});e("#searchReferenciaBtn").click(function(){e("#searchMsg").text(""),y!==null&&y.clear();let t=e("#searchReferencia").val().trim();t&&t!==""&&e.ajax({url:"./ajaxfile.php",type:"post",data:{request:"catasterGeom",refcat:t},dataType:"json",success:function(o){o.length>0?(Oe(o[0].coorx,o[0].coory,!0),wt(o[0].geom)):e("#searchMsg").text("No ha hi cap parcela amb aquesta refer\xE8ncia cadastral.")}})});function Oe(t,o,i=!1){console.log("zoomToCoord:"+t+":"+o);let c=[t,o];i&&(c=Ue([t,o],$e("EPSG:25831"),"EPSG:3857")),r.getView().animate({zoom:r.getView().getZoom()+1,center:c,duration:2e3})}let ae=null,y=null;function wt(t){t&&(ae===null?(y=new x({features:new _().readFeatures(t)}),ae=new L({source:y,style:Be}),r.addLayer(ae)):(y.clear(),y.addFeatures(new _().readFeatures(t))))}let A=null,oe=null;function mt(t){console.log("showIcon:"+t[0]+":"+t[1]),A===null?(oe=new Qe(t),A=new L({source:new x({features:[new et({geometry:oe})]}),style:new f({image:new tt({anchor:[.5,0],anchorOrigin:"bottom-left",color:[255,0,0,1],src:"./marker.png"})})}),r.addLayer(A)):oe.setCoordinates(t)}function Ee(t){return!isNaN(parseFloat(t))&&isFinite(t)}r.on("click",function(t){y!==null&&y.clear(),r.removeLayer(A),A=null,console.log(at(t.coordinate))});const re={sameSite:"strict",secure:!0};function ht(){N.get("comeback")===void 0&&(N.set("comeback",!0,re),O.setActive(!0),M.show()),e.ajax({url:"./translations.json",dataType:"json",success:function(t){let o=pt();a.init({lng:o,debug:!0,resources:t}).then(function(i){Me(),a.on("languageChanged",()=>{N.set("lang",a.language,re),Me()})})}})}function pt(){let t="ca";return N.get("lang")===void 0?N.set("lang",t,re):t=N.get("lang"),t==="es"?U.setActive(!0):K.setActive(!0),t}function Me(){O.setTitle(a.t("gui.documents")),j.setTitle(a.t("gui.capes")),R.setTitle(a.t("gui.search")),e("#windowDocs .text").text(a.t("gui.windowDocsText")),e("#windowSearch .titleCarrer").text(a.t("search.titleCarrer")),e("#windowSearch .labelCarrer").text(a.t("search.labelCarrer")),e("#windowSearch .labelNumero").text(a.t("search.labelNumero")),e("#windowSearch #searchOption").text(a.t("search.searchOption")),e("#windowSearch .titleCatastro").text(a.t("search.titleCatastro")),e("#windowSearch .introCatastro").text(a.t("search.introCatastro")),e("#windowSearch .labelReferencia").text(a.t("search.labelReferencia")),e("#windowSearch .btnReferencia").text(a.t("search.btnReferencia")),e(".ol-permalink button").attr("title",a.t("gui.urlmsg")),G.setTitle(a.t("gui.geopos")),E.setTitle(a.t("gui.measure")),$.setTitle(a.t("gui.measureDistance")),Q.setTitle(a.t("gui.measureArea")),e(".ol-attribution button").attr("title",a.t("gui.attribution")),e("#windowDocs .title").text(a.t("gui.windowDocsTitle")),e("#windowLayers .title").text(a.t("gui.windowLayersTitle")),e("#windowSearch .title").text(a.t("gui.windowSearchTitle")),e("#windowFeature .title").text(a.t("gui.windowFeatureTitle")),e("#windowFeature .label.eix_ncar").text(a.t("feature.eix_ncar")),e("#windowFeature .label.observacions").text(a.t("feature.observacions")),e("#windowFeature .label.estat").text(a.t("feature.estat")),e("#windowFeature .label.data_inici_obres").text(a.t("feature.data_inici_obres")),e("#windowFeature .label.data_fi_obres").text(a.t("feature.data_fi_obres")),e("#windowFeature .label.refcat").text(a.t("feature.refcat")),e("#windowFeature .label.residual").text(a.t("feature.residual")),e("#windowFeature .label.conveni").text(a.t("feature.conveni")),te.set("title",a.t("switcher.parcellesLayer")),ee.set("title",a.t("switcher.tramsLayer")),_e.set("title",a.t("switcher.pluvialLayer")),Ne.set("title",a.t("switcher.barrisLayer")),ke.set("title",a.t("switcher.topoLayer")),Se.set("title",a.t("switcher.catastroLayer")),Te.set("title",a.t("switcher.baseLayers")),xe.set("title",a.t("switcher.topoBaseLayer")),Le.set("title",a.t("switcher.ortoLayer")),Ce.set("title",a.t("switcher.osmLayer")),ye.set("title",a.t("switcher.ninguLayer")),fe.renderPanel(r,document.getElementById("layerSwitcher"),{reverse:!0})}e(function(){ft(),gt(),ht()});
//# sourceMappingURL=index.dbc55449.js.map
